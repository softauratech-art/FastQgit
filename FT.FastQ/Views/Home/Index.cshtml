@model FT.FastQ.Models.LoginViewModel
@using FT.FastQ.Helpers
@{
    ViewBag.Title = ResourceHelper.GetResourceString("Login");
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title - FastQ</title>
    <link href="~/Content/Site.css" rel="stylesheet" />
    <style>
        .code-input {
            width: 40px;
            height: 40px;
            text-align: center;
            font-size: 18px;
            margin: 0 4px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .code-separator {
            margin: 0 8px;
            font-size: 18px;
            font-weight: bold;
            display: flex;
            align-items: center;
            height: 40px;
            line-height: 40px;
        }
        .code-input-container {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="login-box">
            <h2>@ResourceHelper.GetResourceString("Login")</h2>

            @using (Html.BeginForm("Continue", "Home", FormMethod.Post, new { @id = "loginForm" }))
            {
                @Html.AntiForgeryToken()

                <!-- UserInfo Section - Visible by default or when ShowCodeVerification is false -->
                <div id="UserInfo" class="section" style="@(Model.ShowCodeVerification ? "display: none;" : "display: block;")">
                    <div class="form-group email-group">
                        @Html.LabelFor(m => m.Email, new { @for = "Email" })
                        @Html.TextBoxFor(m => m.Email, new { @class = "form-control", placeholder = "Enter your email address" })
                    </div>
                    <div class="form-group">
                        @Html.ValidationMessageFor(m => m.Email, "", new { @class = "error-message" })
                        @if (!string.IsNullOrEmpty(Model.EmailError))
                        {
                            <span class="error-message">@Model.EmailError</span>
                        }
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary btn-continue">@ResourceHelper.GetResourceString("Continue")</button>
                    </div>
                </div>
            }

            @using (Html.BeginForm("VerifyCode", "Home", FormMethod.Post, new { @id = "verifyForm" }))
            {
                @Html.AntiForgeryToken()
                @Html.HiddenFor(m => m.Email)

                <!-- CodeVerify Section - Hidden by default, shown when ShowCodeVerification is true -->
                <div id="CodeVerify" class="section" style="@(Model.ShowCodeVerification ? "display: block;" : "display: none;")">
                    @if (!string.IsNullOrEmpty(Model.CodeMessage))
                    {
                        <div class="form-group">
                            <span class="info-message">@Model.CodeMessage</span>
                        </div>
                    }
                    <div class="form-group">
                        <label for="VerificationCode">@ResourceHelper.GetResourceString("VerificationCode")</label>
                        <div class="code-input-container">
                            <input type="text" id="txtCode1" name="code1" class="code-input" maxlength="1" />
                            <input type="text" id="txtCode2" name="code2" class="code-input" maxlength="1" />
                            <input type="text" id="txtCode3" name="code3" class="code-input" maxlength="1" />
                            <span class="code-separator">-</span>
                            <input type="text" id="txtCode4" name="code4" class="code-input" maxlength="1" />
                            <input type="text" id="txtCode5" name="code5" class="code-input" maxlength="1" />
                            <input type="text" id="txtCode6" name="code6" class="code-input" maxlength="1" />
                        </div>
                        <input type="hidden" id="VerificationCode" name="VerificationCode" />
                        <input type="hidden" name="Email" value="@Model.Email" />
                        @if (!string.IsNullOrEmpty(Model.CodeError))
                        {
                            <span class="error-message code-error">@Model.CodeError</span>
                        }
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">@ResourceHelper.GetResourceString("VerifyCode")</button>
                    </div>
                </div>
            }
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="~/Scripts/jquery.validate.min.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
    <script src="~/Scripts/Login.js"></script>
</body>
</html>
